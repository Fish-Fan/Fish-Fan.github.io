<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="Java面向对象2"/>




  <meta name="keywords" content="Java, Welcome abroad" />










  <link rel="alternate" href="/default" title="Welcome abroad">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="http://yoursite.com/2017/10/16/Java面向对象2/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> Java面向对象2 - Welcome abroad </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Welcome abroad</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Welcome abroad</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Java面向对象2
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-10-16
        </span>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#内部类"><span class="toc-text">内部类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java异常层次"><span class="toc-text">Java异常层次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#超类和子类的异常"><span class="toc-text">超类和子类的异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建议同时捕获多个异常"><span class="toc-text">建议同时捕获多个异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可以在catch字句中再抛出一个异常，这样做的目的是改变异常的类型"><span class="toc-text">可以在catch字句中再抛出一个异常，这样做的目的是改变异常的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#泛型的声明及调用"><span class="toc-text">泛型的声明及调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#泛型类型变量的限定"><span class="toc-text">泛型类型变量的限定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行时类型查询只适用于原始数据类型"><span class="toc-text">运行时类型查询只适用于原始数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不能创建参数化类型的数组"><span class="toc-text">不能创建参数化类型的数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#泛型类中的静态方法和静态变量不可以使用泛型类所声明的泛型类型参数"><span class="toc-text">泛型类中的静态方法和静态变量不可以使用泛型类所声明的泛型类型参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注意擦除后的冲突"><span class="toc-text">注意擦除后的冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#队列-queue"><span class="toc-text">队列(queue)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Collection接口"><span class="toc-text">Collection接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#迭代器"><span class="toc-text">迭代器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#集合框架中的接口"><span class="toc-text">集合框架中的接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java具体集合"><span class="toc-text">Java具体集合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链表"><span class="toc-text">链表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#散列集"><span class="toc-text">散列集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#树集"><span class="toc-text">树集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#队列"><span class="toc-text">队列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#映射"><span class="toc-text">映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线程安全的容器（简记为“喂，SHE”）"><span class="toc-text">线程安全的容器（简记为“喂，SHE”）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#枚举类型-不能被继承"><span class="toc-text">枚举类型(不能被继承)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#枚举中的values"><span class="toc-text">枚举中的values():</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#任务的定义"><span class="toc-text">任务的定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread类"><span class="toc-text">Thread类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Executor"><span class="toc-text">使用Executor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#从任务中产生返回值"><span class="toc-text">从任务中产生返回值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#休眠"><span class="toc-text">休眠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优先级"><span class="toc-text">优先级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#后台线程-daemon"><span class="toc-text">后台线程(daemon)</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p>使用 <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd> 重启电脑<br>$$ x = {-b \pm \sqrt{b^2-4ac} \over 2a}. $$</p>
<p>$$<br>x \href{why-equal.html}{=} y^2 + 1<br>$$</p>
<h3 id="内部类"><a href="#内部类" class="headerlink" title="内部类"></a>内部类</h3><ol>
<li><p>常规内部类<br><img src="http://ok2crkjlq.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-10-16%20%E4%B8%8B%E5%8D%888.46.31.png" alt="常规内部类的组成"></p>
<ul>
<li>只有内部类可以声明为 <strong>private</strong>，常规类只可以被声明为 <strong>public和protected</strong></li>
<li>内部类可以访问外部类私有域的成员变量</li>
<li>内部类不允许有静态方法和变量<a id="more"></a>
</li>
</ul>
</li>
<li><p>静态内部类</p>
<ul>
<li>静态内部类不允许访问外围类对象</li>
<li>静态内部类可以有静态方法和静态变量</li>
<li>声明在接口中的内部类自动成为static和public类</li>
</ul>
</li>
</ol>
<h3 id="Java异常层次"><a href="#Java异常层次" class="headerlink" title="Java异常层次"></a>Java异常层次</h3><p><img src="http://ok2crkjlq.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-10-16%20%E4%B8%8B%E5%8D%888.54.41.png" alt="Java异常层次"></p>
<h3 id="超类和子类的异常"><a href="#超类和子类的异常" class="headerlink" title="超类和子类的异常"></a>超类和子类的异常</h3><ul>
<li>如果在子类中覆盖了超类的一个方法，子类方法中声明的受查异常不能比超类中声明的异常更通用(应该抛出更具体的异常)</li>
<li>如果超类方法没有抛出任何受查异常，子类也不能抛出</li>
</ul>
<h3 id="建议同时捕获多个异常"><a href="#建议同时捕获多个异常" class="headerlink" title="建议同时捕获多个异常"></a>建议同时捕获多个异常</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">catch</span>(FileNotFoundException | UnkownHostException e) &#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="可以在catch字句中再抛出一个异常，这样做的目的是改变异常的类型"><a href="#可以在catch字句中再抛出一个异常，这样做的目的是改变异常的类型" class="headerlink" title="可以在catch字句中再抛出一个异常，这样做的目的是改变异常的类型"></a>可以在catch字句中再抛出一个异常，这样做的目的是改变异常的类型</h3><p>下列代码表明执行sevlet的代码可能不想知道发生错误的具体类型，但是希望明确知道servlet是否有问题。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="comment">//access the database</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span>(SQLException e) &#123;</div><div class="line">  <span class="comment">//这样做可以让用户抛出多个异常，而又不会丢失原始异常的细节</span></div><div class="line">  Throwable se = <span class="keyword">new</span> ServletException(<span class="string">"db error"</span>);</div><div class="line">  se.init(e);</div><div class="line">  <span class="keyword">throw</span> se;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="泛型的声明及调用"><a href="#泛型的声明及调用" class="headerlink" title="泛型的声明及调用"></a>泛型的声明及调用</h3><ul>
<li>泛型类： 位于类名的后面</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>泛型方法: 位于修饰符的后面，返回类型的前面</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">getMiddle</span><span class="params">(T...a)</span> </span>&#123;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在调用的泛型方法的时候，可以指定泛型具体参数，也可以不指定泛型具体参数.</p>
<ul>
<li>在不指定泛型的情况下，泛型变量的类型为该方法的几种类型的同一个父类的最小级，直到Object.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Integer和Float最小父类是Number</span></div><div class="line">Number num = Test.getMiddle(<span class="number">1</span>,<span class="number">1.2</span>);</div><div class="line"><span class="comment">//Integer和String最下父类是Object</span></div><div class="line">Object o = Test.getMiddle(<span class="number">1</span>,<span class="string">"aaa"</span>);</div></pre></td></tr></table></figure>
<ul>
<li>在指定泛型的情况下，会发生编译错误</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> a = Test.&lt;Integer&gt;getMiddle(<span class="number">1</span>,<span class="number">1.2</span>);</div></pre></td></tr></table></figure>
<h3 id="泛型类型变量的限定"><a href="#泛型类型变量的限定" class="headerlink" title="泛型类型变量的限定"></a>泛型类型变量的限定</h3><p>下例将T限制为实现了Comparable接口的类。<br>一个类型变量或通配符可以有多个限定<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">T extends Comparable &amp; Serializable</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Comparable&gt; <span class="function">T <span class="title">min</span><span class="params">(T[] a)</span> </span>&#123;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="运行时类型查询只适用于原始数据类型"><a href="#运行时类型查询只适用于原始数据类型" class="headerlink" title="运行时类型查询只适用于原始数据类型"></a>运行时类型查询只适用于原始数据类型</h3><p>由于类型擦出机制的存在，虚拟机中的对象总有一个特定的非泛型类型，因此所有的类型查询只产生原始类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(a <span class="keyword">instanceof</span> Pair&lt;String&gt;) <span class="comment">//error</span></div><div class="line"><span class="keyword">if</span>(a <span class="keyword">instanceof</span>) Pair&lt;T&gt;)     <span class="comment">//error</span></div></pre></td></tr></table></figure>
<p>getClass()方法总是返回原始类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Pair&lt;String&gt; a1 = ...;</div><div class="line">Pair&lt;Emploee&gt; a2 = ...;</div><div class="line"><span class="keyword">if</span>(a1.getClass() == a2.getClass())   <span class="comment">//true</span></div></pre></td></tr></table></figure>
<h3 id="不能创建参数化类型的数组"><a href="#不能创建参数化类型的数组" class="headerlink" title="不能创建参数化类型的数组"></a>不能创建参数化类型的数组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Pair&lt;String&gt;[] table = <span class="keyword">new</span> Pair&lt;String&gt;[<span class="number">10</span>];  <span class="comment">//error</span></div></pre></td></tr></table></figure>
<p>因为类型擦除机制使得table能够存放任意类型的对象，所以必须使用 <strong>ArrayList</strong> 对象。</p>
<h3 id="泛型类中的静态方法和静态变量不可以使用泛型类所声明的泛型类型参数"><a href="#泛型类中的静态方法和静态变量不可以使用泛型类所声明的泛型类型参数" class="headerlink" title="泛型类中的静态方法和静态变量不可以使用泛型类所声明的泛型类型参数"></a>泛型类中的静态方法和静态变量不可以使用泛型类所声明的泛型类型参数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> T singleInstance;         <span class="comment">//error</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> T <span class="title">getSingleInstance</span><span class="params">()</span> </span>&#123;    <span class="comment">//error</span></div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为泛型类中的泛型参数的实例化是在定义对象的时候制定的，而静态变量和静态方法不需要对象来调用，所以是错误的。</p>
<h3 id="注意擦除后的冲突"><a href="#注意擦除后的冲突" class="headerlink" title="注意擦除后的冲突"></a>注意擦除后的冲突</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(T ob)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> first.equals(ob);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>类型擦除后，类中存在两个 <strong>boolean equals(Object o)</strong> 方法，引起冲突，补救措施-&gt;rename</p>
<p>要想支持擦除的转化，就需要强行限制一个类或类型变量不能同时成为两个接口类型的子类，且这两个接口是同一接口的不同参数化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Emploee</span> <span class="title">implments</span> <span class="title">Comparable</span>&lt;<span class="title">Emploee</span>&gt; </span>&#123;...&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Emploee</span> <span class="title">implments</span> <span class="title">Comparable</span>&lt;<span class="title">Manager</span>&gt; </span>&#123;...&#125;  <span class="comment">//error</span></div></pre></td></tr></table></figure>
<h3 id="队列-queue"><a href="#队列-queue" class="headerlink" title="队列(queue)"></a>队列(queue)</h3><p>队尾添加元素，头部删除元素，并且可以查找队列中元素的个数<br>规则： 先进先出(FIFO)<br>实现方式： 循环数组，链表<br>两种实现方式的比较： 循环数组比链表更高效，但容量也有限，删除(或插入)中间元素时效率很差(因为需要一个一个进行移位操作)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt; </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span></span>;</div><div class="line">  <span class="function">E <span class="title">remove</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Collection接口"><a href="#Collection接口" class="headerlink" title="Collection接口"></a>Collection接口</h3><p>在Java类库中，集合类的基本接口是Collection接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Collection</span>&lt;<span class="title">E</span>&gt; </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object e)</span></span>;</div><div class="line">  <span class="function">Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object e)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">containsAll</span><span class="params">(Collection&lt;?&gt; c)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">retainAll</span><span class="params">(Collection&lt;?&gt; c)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">int</span> <span class="title">hasCode</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><p>Iterator接口包含4个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</div><div class="line">  <span class="function">E <span class="title">next</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</div><div class="line">  <span class="comment">//删除上次访问对象</span></div><div class="line">  <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">forEachRemaining</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> E&gt; action)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过反复调用next方法，可以逐个访问集合中的每个元素，如果到达了集合的末尾，next()方法将抛出 NoSuchElementException. 因此需在调next()方法之前调用hasNext();<br>如果想要查看集合中的所有元素，就请求一个迭代器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Collection&lt;String&gt; collection = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">Iterator&lt;String&gt; iterator = collection.iterator();</div><div class="line"><span class="keyword">while</span>(iterator.hasNext()) &#123;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ListIterator可以实现双向遍历</strong></p>
<h3 id="集合框架中的接口"><a href="#集合框架中的接口" class="headerlink" title="集合框架中的接口"></a>集合框架中的接口</h3><p><img src="http://ok2crkjlq.bkt.clouddn.com/IMG_3840.JPG" alt="集合框架中的接口"><br>List是一个有序集合，元素会增加到容器的特定位置。<br>List的访问方式：</p>
<ol>
<li>使用迭代器访问(必须顺序访问)</li>
<li>使用整数索引来访问</li>
</ol>
<h3 id="Java具体集合"><a href="#Java具体集合" class="headerlink" title="Java具体集合"></a>Java具体集合</h3><p><img src="http://ok2crkjlq.bkt.clouddn.com/IMG_3841.JPG" alt="Java具体集合"></p>
<h3 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h3><p><img src="http://ok2crkjlq.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-10-27%20%E4%B8%8B%E5%8D%884.20.40.png" alt="链表"></p>
<p>Vector: Vector之所以没在图中体现是因为这是Java集合中的遗留类，但是Vector所有方法都是同步的，我们平时使用单线程应用时，应该优先选择使用ArrayList.<br>ArrayList: 使用数组实现，从中间插入/删除元素很困难，但是按索引访问效率高。<br>LinkedList: 按索引访问效率很差，需要一个一个向下面遍历知道找到要访问的元素。</p>
<p>使用ListIterator向LinkedList中添加元素:<br><strong>Java语言中的所有链表都是双向链表</strong>，链表是一个有序集合，每个对象的位置十分重要，由于迭代器是描述集合中位置的，只有通过迭代器对有序集合添加元素才更有意义，但Iterator接口中没有add(),其子接口ListIterator中包含add().</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ListIterator&lt;String&gt; iter = staff.listIterator();</div><div class="line"><span class="comment">//add()在迭代器位置之前添加一个元素</span></div><div class="line">iter.next();</div><div class="line">iter.add(<span class="string">"tom"</span>);</div></pre></td></tr></table></figure>
<p>如果多次调用add(),将依次把各元素添加至当前迭代器位置之前。</p>
<h3 id="散列集"><a href="#散列集" class="headerlink" title="散列集"></a>散列集</h3><p>散列表不在意元素的顺序，但其可以实现快速的查找所需要的对象。<br>在Java中，散列表使用链表数组实现，要想要查找表中对象的位置，就要先计算他的散列码，然后与桶(bucket)的总数取余。</p>
<p><img src="http://ok2crkjlq.bkt.clouddn.com/IMG_3842.JPG" alt="散列表的逻辑结构"></p>
<p>桶满的情况下，需要将新对象逐个与链表中的对象进行比较，查看这个对象是否已经存在(Java SE8中，桶满是会从链表变为平衡二叉树).<br>如果想控制散列表的运行性能，就要指定一个初始的桶数，通常将桶数设置在预计元素的75%~150%。<br>当然，并不是总能预先知道需要存的元素的个数，如果散列表太满，就需要进行再散列(rehashed)，即创建一个桶数更多的表，并将所有元素插入到新表中，然后丢弃原来的表，何时丢弃由装填因子(load factor)决定，默认为0.75</p>
<h3 id="树集"><a href="#树集" class="headerlink" title="树集"></a>树集</h3><p>TreeSet类(使用红黑树实现)与散列集十分类似，不过它比散列集有所改进，它是一个有序集合，可以以任意的顺序将元素插入到集合中，在对集合进行遍历时，每个值将自动的按照排序后的顺序出现。</p>
<h3 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h3><p>双端队列: Java SE6引入了Deque接口，并由ArrayDeque和LinkedList类实现，这两个类都提供双端队列，双端队列即可以在头部和尾部同时添加或删除元素。</p>
<p>优先级队列(priority queue): 可以按照任意的顺序插入，却总是按照排序的顺序进行检索(使用堆(heap)来实现)</p>
<h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><p>Java类库为映射提供了两个通用的实现：HashMap和TreeMap,这两个类都实现了Map接口</p>
<ul>
<li>HashMap: 使用散列表实现，可以快速的查找键/值</li>
<li>LinkedHashMap: 迭代遍历时，按插入次序遍历，迭代时也可以按照LRU(最近最少使用算法，长时间未使用的在前)次序迭代，迭代访问比HashMap快，因为它使用链表维护内部次序。</li>
<li>WeakHashMap: 允许释放映射所指的对象</li>
<li>ConcurrentHashMap: 线程安全的Map</li>
<li>IdentityHashMap: 使用==代替equals()对键进行比较</li>
</ul>
<h3 id="线程安全的容器（简记为“喂，SHE”）"><a href="#线程安全的容器（简记为“喂，SHE”）" class="headerlink" title="线程安全的容器（简记为“喂，SHE”）"></a>线程安全的容器（简记为“喂，SHE”）</h3><p>Vector: 效率低，但是比ArrayList多了个同步化机制，在web应用中特别是前台页面，往往效率优先，故不常使用。<br>Stack:<br>hashtable: 比hashMap多了个线程安全<br>enumeration:</p>
<h3 id="枚举类型-不能被继承"><a href="#枚举类型-不能被继承" class="headerlink" title="枚举类型(不能被继承)"></a>枚举类型(不能被继承)</h3><p>枚举是一组含有有限个具名值的集合，使用关键字enum声明枚举类型<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">enum</span> shrubbery &#123;GROUND,CRAWLING,HANGING&#125;</div></pre></td></tr></table></figure></p>
<p>除了不能继承一个enum外，基本上可以将enum看做一个常规的类，甚至可以有main()方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> EnumTest&#123;</div><div class="line">  WOLF(<span class="string">"This is a wolf"</span>),</div><div class="line">  TIGET(<span class="string">"This is a tiger"</span>),</div><div class="line">  SNAKE(<span class="string">"This is a snake"</span>);</div><div class="line"></div><div class="line">  <span class="comment">//必须在实例之后定义方法和变量</span></div><div class="line">  <span class="keyword">private</span> String desc;</div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> desc;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">//构造函数声明为private</span></div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="title">EnumTest</span><span class="params">(String desc)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.desc = desc;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(EnumTest item : EnumTest.values()) &#123;</div><div class="line">  System.out.println(item + item.getDesc());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="枚举中的values"><a href="#枚举中的values" class="headerlink" title="枚举中的values():"></a>枚举中的values():</h3><p>我们原本声明的枚举类Explore<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">enum</span> Explore&#123;</div><div class="line">  HERE,THERE</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>经过编译后变为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Explore</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Enun</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Explore HERE;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Explore THERE;</div><div class="line">  <span class="comment">//自动添加</span></div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Explorep[] values();</div><div class="line">  <span class="comment">//自动添加</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Explore <span class="title">valueOf</span><span class="params">(java.lang.String)</span></span>;</div><div class="line">  <span class="keyword">static</span>&#123;&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="任务的定义"><a href="#任务的定义" class="headerlink" title="任务的定义"></a>任务的定义</h3><p>线程可以驱动任务，而任务的实现必须实现Runnable接口并编写run()方法。<br>任务的run()方法通常会有某种形式的循环，使得任务一直运行下去直到不再需要。<br>在run()方法中对静态方法Thread.yield()的调用是对线程调度器的一种建议，建议它切换至另一个任务执行。</p>
<h3 id="Thread类"><a href="#Thread类" class="headerlink" title="Thread类"></a>Thread类</h3><p>将Runnable对象转变为工作任务的传统方式是把它提交给一个Thread构造器。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicThread</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> LiftOff());</div><div class="line">    t.start();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="使用Executor"><a href="#使用Executor" class="headerlink" title="使用Executor"></a>使用Executor</h3><p>Executor在客户端和任务执行之间提供了一个间接层，与客户端直接执行任务不同，这个中介对象将执行任务。<strong>Executor允许你管理异步任务的执行，而无需显式的管理线程的声明周期</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ExecutorService exec = Executors.newCachedThreadPool();</div><div class="line">exec.execute(<span class="keyword">new</span> LiftOff());</div><div class="line"><span class="comment">//防止新任务被提交给exec</span></div><div class="line">exec.shutdown();</div></pre></td></tr></table></figure>
<ul>
<li>newCachedThreadPool(): 运行时为每个线程分派一个线程。</li>
<li>newFixedThreadPool(): 一次性执行代价高昂的线程分配。</li>
<li>newSingleThreadExecutor(): 一次只运行一个线程，多个需要排队.</li>
</ul>
<h3 id="从任务中产生返回值"><a href="#从任务中产生返回值" class="headerlink" title="从任务中产生返回值"></a>从任务中产生返回值</h3><p>Runnable是执行工作中的独立任务，不产生任何返回值，如果希望任务完成时能够返回一个值，那么可以实现Callable接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> TaskWithResult implements Callable&lt;String&gt; &#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TaskWithResult</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.id = id;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">call</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"result is "</span> + id;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">ExecutorService exec = Executors.newCachedThreadPool();</div><div class="line">ArrayList&lt;Future&lt;String&gt;&gt; array = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">5</span>;i++) &#123;</div><div class="line">  <span class="comment">//必须通过submit()来调用，调用之后返回Future对象</span></div><div class="line">  array.add(exec.submit());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(Future&lt;String&gt; fu : array) &#123;</div><div class="line">  <span class="comment">//使用get()获取结果，获取结果前可以使用isDone()来检查是否完成</span></div><div class="line">  System.out.println(fu.get());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="休眠"><a href="#休眠" class="headerlink" title="休眠"></a>休眠</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  TimeUnit.MILLSECONDS.sleep(<span class="number">100</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">  System.err.println(<span class="string">"interrupted"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">//在run()方法开头设置优先级</span></div><div class="line">  Thread.currentThread().setPriority(<span class="number">10</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>一般调整优先级时，只是用MAX_PRIORITY,NORM_PRIORITY,MIN_PRIORITY这三个级别.</p>
<h3 id="后台线程-daemon"><a href="#后台线程-daemon" class="headerlink" title="后台线程(daemon)"></a>后台线程(daemon)</h3><p>后台线程不属于程序中不可或缺的一部分，当所有的非后台程序全部执行完毕时，程序也就终止了，同时会杀死进程中的所有后台线程，反过来说，只要有任何非后台线程在运行，程序就不会终止。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Thread t = <span class="keyword">new</span>  Thread(<span class="keyword">new</span> LiftOff());</div><div class="line">t.setDaemon(<span class="keyword">true</span>);</div><div class="line">t.start();</div></pre></td></tr></table></figure>
<p>可以通过调用isDaemon()来判断一个线程是否是一个后台线程，如果是一个后台线程，那么它创建的所有后台线程也都是后台线程。<br>通过编写定制的ThreadFactory()可以定制由Executor创建的线程的属性.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaemonThreadFactory</span> <span class="keyword">implements</span> <span class="title">ThreadFactory</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Thread <span class="title">newThread</span><span class="params">(Runnable r)</span> </span>&#123;</div><div class="line">    Thread t = <span class="keyword">new</span> Thread(r);</div><div class="line">    t.setDaemon(<span class="keyword">true</span>);</div><div class="line">    <span class="keyword">return</span> t;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ExecutorService exec = Exectors.newCachedThreadPool(<span class="keyword">new</span> DaemonThreadFactory());</div></pre></td></tr></table></figure>
<p>另外，后台线程在不执行finally语句的情况下就会终止run()方法。</p>

      
    </div>

    
      
      



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/weixin.jpg" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.jpg" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Java/">Java</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/11/10/JavaCurrency锁的实现/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">JavaCurrency锁的实现</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2017/09/19/Java面向对象/">
        <span class="next-text nav-default">Java面向对象</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    
      
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Johnny.R</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
